import{t as f,u as y,r as g,j as e,C as b,B as N}from"./index-DxVKGPRw.js";import{T as C}from"./index-Dv4jy6Gk.js";/* empty css            */import{L as F}from"./LinearProgress-B59VYLXh.js";function L(){const i=f(),m=y(),[o,d]=g.useState(!1),[a,l]=g.useState({title:i.state.data.name,director:i.state.data.director,hours:i.state.data.hours,minutes:i.state.data.minutes,rating:i.state.data.rating,actors:i.state.data.actors,year:i.state.data.year,summary:i.state.data.summary,image:i.state.data.poster}),p=new Date().getFullYear(),x=Array.from({length:p-1980+1},(t,s)=>1980+s),n=t=>{const{id:s,value:r}=t.target;l(c=>({...c,[s]:r}))},j=t=>{const s=t.target.value;!isNaN(Number(s))&&Number(s)>=0&&Number(s)<=5?l({...a,rating:s}):s===""&&l({...a,rating:""})},u=t=>{var r;const s=((r=t.target.files)==null?void 0:r[0])||null;l(c=>({...c,image:s}))},v=async t=>{t.preventDefault(),d(!0);const s={};for(const r in a)a[r]&&r!=="image"&&(s[r]=a[r]);try{if(a.image instanceof File){const r=new FileReader;r.readAsDataURL(a.image),r.onloadend=async()=>{s.poster=r.result,await h(s)},r.onerror=()=>{alert("Failed to process the image."),d(!1)}}else s.poster=a.image,await h(s)}catch(r){console.error("Error submitting form:",r),alert("An unexpected error occurred.")}finally{d(!1)}},h=async t=>{try{(await fetch(`http://localhost:3000/movies/${i.state.data.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok?(alert("Movie updated successfully!"),m("/movies")):alert("Failed to update the movie. Please try again.")}catch(s){console.error("Error updating movie:",s),alert("An error occurred while updating the movie.")}};return e.jsxs("div",{className:"add",children:[o&&e.jsx(F,{})," ",e.jsxs("div",{className:"head",children:[e.jsx("p",{className:"add-title",children:"Edit the movie"}),e.jsx(C,{size:40,onClick:()=>m("/movies")})]}),e.jsxs("form",{onSubmit:v,children:[e.jsxs("div",{className:"fields",children:[e.jsxs("div",{className:"feild",children:[e.jsx("label",{htmlFor:"title",children:"Title"}),e.jsx("input",{type:"text",id:"title",value:a.title,onChange:n})]}),e.jsxs("div",{className:"feild",children:[e.jsx("label",{htmlFor:"director",children:"Director"}),e.jsx("input",{type:"text",id:"director",value:a.director,onChange:n})]}),e.jsxs("div",{className:"feild display",children:[e.jsxs("label",{htmlFor:"display",children:["Display Duration ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs("div",{className:"duration-inputs",children:[e.jsx("input",{type:"number",placeholder:"Hours",min:"0",id:"hours",required:!0,value:a.hours,onChange:t=>l({...a,hours:t.target.value})}),e.jsx("input",{className:"input2",type:"number",placeholder:"Minutes",min:"0",max:"59",id:"minutes",required:!0,value:a.minutes,onChange:t=>l({...a,minutes:t.target.value})})]})]}),e.jsxs("div",{className:"feild",children:[e.jsx("label",{htmlFor:"rating",children:"Rating"}),e.jsx("input",{type:"text",id:"rating",value:a.rating,onChange:j})]}),e.jsxs("div",{className:"feild",children:[e.jsx("label",{htmlFor:"actors",children:"Actors"}),e.jsx("input",{type:"text",id:"actors",value:a.actors,onChange:n})]}),e.jsxs("div",{className:"feild",children:[e.jsxs("label",{htmlFor:"year",children:["Year ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs("select",{id:"year",required:!0,value:a.year,onChange:t=>l({...a,year:t.target.value}),children:[e.jsx("option",{value:"",disabled:!0,children:"Select a year"}),x.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{className:"feild summary",children:[e.jsx("label",{htmlFor:"summary",children:"Summary"}),e.jsx("textarea",{rows:4,id:"summary",value:a.summary,onChange:n})]}),e.jsx("button",{className:"btn",disabled:o,children:o?e.jsx(b,{size:20,color:"inherit"}):"Save"})]}),e.jsxs("div",{className:"add-img",children:[e.jsx("p",{children:"Poster"}),a.image?e.jsxs("div",{children:[e.jsxs("div",{className:"container",children:[e.jsx("img",{src:typeof a.image=="string"?a.image:URL.createObjectURL(a.image),alt:"Poster Preview",className:"full-container-image"}),e.jsx("input",{id:"file",type:"file",accept:"image/*",onChange:u})]}),e.jsx("label",{className:"change-label",htmlFor:"file",children:"Change Poster"})]}):e.jsxs("div",{children:[e.jsx("label",{htmlFor:"file",children:e.jsx(N,{size:100})}),e.jsx("input",{id:"file",type:"file",accept:"image/*",onChange:u})]})]})]})]})}export{L as default};
